<!-- Provider Selection -->
<div class="mb-8 ">
    <div class="flex gap-4">
        <button *ngFor="let provider of providers" class="flex items-center gap-2" [class.opacity-40]="!provider.active"
            (click)="toggleProvider(provider)">
            <div class="flex h-12 w-12 items-center justify-center rounded-full" [ngClass]="provider.color">
                <img [src]="provider.src" alt="">
            </div>
            <span class="text-base font-medium">{{ provider.label }}</span>
        </button>
    </div>
</div>

<nz-tabset class="mb-8 provider" [(nzSelectedIndex)]="selectedIndex">
    <nz-tab nzTitle="Top Up"> <!-- Form Fields -->
        <form [formGroup]="topForm" (ngSubmit)="onSubmit()">
            <!-- Number Field -->
            <div class="relative mb-6">
                <label class="block text-black font-normal text-sm mb-2">Number</label>
                <div class="flex items-center py-2 w-full max-w-[327px] border-b-2 border-solid" [ngClass]="{ 
                        'border-[#FCD759]': !(f['number'].invalid && (f['number'].touched || submitted)), 
                        'border-[#DBA434]': f['number'].invalid && (f['number'].touched || submitted) 
                    }">
                    <span class="text-yellow-500">
                        <i class="fa-regular fa-phone"></i>
                    </span>
                    <input type="text" formControlName="number"
                        class="ml-2 w-full outline-none text-lg text-gray-900 bg-transparent"
                        placeholder="Enter number">
                </div>
                <div class="px-1 w-100 position-absolute mt-1">
                    <small class="error text-red d-flex flex-column space-y-1.5"
                        *ngIf="f['number'].invalid && (f['number'].touched || submitted)">
                        <span *ngIf="f['number'].errors?.['required']">This Field is required</span>
                    </small>
                </div>
            </div>

            <!-- Amount Field -->
            <div class="relative mb-6">
                <label class="block text-black font-normal text-sm mb-2">Amount</label>
                <div class="flex items-center py-2 w-full max-w-[327px] border-b-2 border-solid" [ngClass]="{ 
                        'border-[#FCD759]': !(f['amount'].invalid && (f['amount'].touched || submitted)), 
                        'border-[#DBA434]': f['amount'].invalid && (f['amount'].touched || submitted) 
                    }">
                    <span class="text-yellow-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path
                                d="M3 20C5.33579 17.5226 8.50702 16 12 16C15.493 16 18.6642 17.5226 21 20M16.5 7.5C16.5 9.98528 14.4853 12 12 12C9.51472 12 7.5 9.98528 7.5 7.5C7.5 5.01472 9.51472 3 12 3C14.4853 3 16.5 5.01472 16.5 7.5Z"
                                stroke="url(#paint0_linear_238_128)" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <defs>
                                <linearGradient id="paint0_linear_238_128" x1="3.66349" y1="3" x2="24.6663" y2="30.9068"
                                    gradientUnits="userSpaceOnUse">
                                    <stop stop-color="#FCD759" stop-opacity="0.9686" />
                                    <stop offset="1" stop-color="#DBA434" />
                                </linearGradient>
                            </defs>
                        </svg>
                    </span>
                    <input type="text" formControlName="amount"
                        class="ml-2 w-full outline-none text-lg text-gray-900 bg-transparent"
                        placeholder="Enter amount">
                </div>
                <div class="px-1 w-100 position-absolute mt-1">
                    <small class="error text-red d-flex flex-column space-y-1.5"
                        *ngIf="f['amount'].invalid && (f['amount'].touched || submitted)">
                        <span *ngIf="f['amount'].errors?.['required']">Amount is required</span>
                    </small>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3 pt-4">
                <button type="submit" class="btn-primary  h-12 max-w-[351px] !w-full">Next</button>
                <button type="button" class="btn-ghost h-12  max-w-[88px] !w-full"
                    (click)="topForm.reset()">Cancel</button>
            </div>
        </form>
    </nz-tab>
    <nz-tab nzTitle="Bill Inquiry">
        <form [formGroup]="BillForm" (ngSubmit)="onBillSubmit()">
            <!-- Number Field -->
            <div class="relative mb-6" *ngIf="billselectedIndex === 0">
                <label class="block text-black font-normal text-sm mb-2">Your Number</label>
                <div class="flex items-center py-2 w-full max-w-[327px] border-b-2 border-solid" [ngClass]="{ 
                        'border-[#FCD759]': !(g['secondnumber'].invalid && (g['secondnumber'].touched || Billsubmitted)), 
                        'border-[#DBA434]': g['secondnumber'].invalid && (g['secondnumber'].touched || Billsubmitted) 
                    }">
                    <span class="text-yellow-500">
                        <i class="fa-regular fa-phone"></i>
                    </span>
                    <input type="text" formControlName="secondnumber"
                        class="ml-2 w-full outline-none text-lg text-gray-900 bg-transparent"
                        placeholder="Enter number">
                </div>
                <div class="px-1 w-100 position-absolute mt-1">
                    <small class="error text-red d-flex flex-column space-y-1.5"
                        *ngIf="g['secondnumber'].invalid && (g['secondnumber'].touched || Billsubmitted)">
                        <span *ngIf="g['secondnumber'].errors?.['required']">This Field is required</span>
                    </small>
                </div>
            </div>

            <div *ngIf="billselectedIndex === 1">
                <nz-select formControlName="thirdnumber" [(ngModel)]="selectedValue"
                    class="select-number w-full h-[48px] items-center flex">
                    @for (option of listOfOption; track option) {
                    <nz-option [nzLabel]="option" [nzValue]="option"></nz-option>
                    }
                </nz-select>

                <div class="bg-gray-50 px-2 py-4 rounded-lg w-full mt-6">
                    <p class="font-semibold text-gray-800">Number</p>
                    <p class="font-bold text-lg text-gray-900">+2491234567</p>

                    <p class="font-semibold text-gray-800 mt-3">Mount</p>
                    <p class="font-bold text-lg text-gray-900">SDG 32,000,000</p>

                    <p class="font-semibold text-gray-800 mt-3">Date</p>
                    <p class="font-bold text-lg text-gray-900">22.3.2024</p>

                    <p class="font-semibold text-gray-800 mt-3">Services</p>
                    <p class="font-bold text-lg text-gray-900">MTN Bill Inquiry</p>
                </div>
            </div>

            <div *ngIf="billselectedIndex === 2">
                <nz-select formControlName="fournumber" [(ngModel)]="selectedValue"
                    class="select-number w-full h-[48px] items-center flex">
                    @for (option of listOfOption; track option) {
                    <nz-option [nzLabel]="option" [nzValue]="option"></nz-option>
                    }
                </nz-select>
                <div class="w-full bg-gray-50 px-2 py-4 rounded-lg mt-6 flex justify-center">
                    <app-opt [showMessage]="false"></app-opt>
                </div>
            </div>

            <div *ngIf="billselectedIndex === 3" class="w-full bg-gray-50 px-2 py-4 rounded-lg mt-6">
                <div class="space-y-6">
                    <h1 class="text-lg font-semibold text-gray-900 border-b-2 border-yellow-500 mb-3 pb-2">
                        Payment Completed
                    </h1>

                    <div class="space-y-4">
                        <div>
                            <div class="text-sm font-medium text-gray-600">Number</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.number }}</div>
                        </div>

                        <div>
                            <div class="text-sm font-medium text-gray-600">Account</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.account }}</div>
                        </div>

                        <div>
                            <div class="text-sm font-medium text-gray-600">Amount</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.amount }}</div>
                        </div>

                        <div>
                            <div class="text-sm font-medium text-gray-600">Date</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.date }}</div>
                        </div>

                        <div>
                            <div class="text-sm font-medium text-gray-600">Services</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.services }}</div>
                        </div>

                        <div>
                            <div class="text-sm font-medium text-gray-600">Transaction ID</div>
                            <div class="text-base text-gray-900">{{ paymentDetails.transactionId }}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3 pt-4">
                <button *ngIf="billselectedIndex === 0" type="submit"
                    class="btn-primary h-12 max-w-[351px] !w-full">Next</button>
                <button *ngIf="billselectedIndex === 1" type="submit"
                    class="btn-primary h-12 max-w-[351px] !w-full">Confirm</button>
                <button *ngIf="billselectedIndex === 2" type="submit"
                    class="btn-primary h-12 max-w-[351px] !w-full">Confirm</button>
                <button type="button" *ngIf="billselectedIndex < 3"
                    class="btn-ghost h-12  max-w-[88px] !w-full">Cancel</button>
                <button *ngIf="billselectedIndex === 3"
                    class="mt-6 btn-primary h-12 max-w-[351px] !w-full">
                    Download Invoice
                </button>
            </div>
        </form>
    </nz-tab>
    <nz-tab nzTitle="Scratches">Content of Tab Pane 3</nz-tab>
</nz-tabset>